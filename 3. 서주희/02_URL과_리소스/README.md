# 01 HTTP - 웹의 기초

### 2장 URL 과 리소스

#### 2.1 인터넷의 리소스 탐색하기

- URL은 통합 자원 식별자 (Uniform Resource Identifier) 혹은 URI라고 불리는 더 일반화된 부류의 부분집합이다. URI는 두 가지 주요 부분집합인, URL과 URN으로 구성된 종합적인 개념이다.

  `URN`은 현재 그 리소스가 어디에 존재하든 그 **이름만으로 리소스를 식별** 하는데 비해 `URL`은 리소스가 **어디 있는지 설명** 해서 리소스를 식별한다.

HTTP 명세에서는 URI를 더 일반화된 개념의 리소스 식별자로 사용한다.

만일, `http://www.hoes-hardware.com/seasonal/index-fall.html`이라는 URL을 불러오고 싶다고 해보자.

- URL의 첫 부분인 http는 URL의 스킴이다. 스킴은 웹 클라이언트가 리소스에 어떻게 접근하는 지 알려준다. 이 경우, URL이 HTTP 프로토콜을 사용한다.

- URL의 두번 째 부분인 `www.joes-hardware.com` 은 서버의 위치다. 이는 웹 클라이언트가 **_리소스가 어디에 호스팅 되어 있는지_** 를 알려준다.

- URL의 세 번째 부분인 `/seosonal/index-fall.html` 은 리소스 경로다. 경로는 서버에 존재하는 로컬 리소스들 중에서 요청받은 리소스가 무엇인지 알려준다.

<br>

---

#### 2.1.1 URL이 있기 전 암흑의 시대 ( URL의 필요성 )

<br>

- 웹과 URL이 있기 전에는 데이터에 접근하기 위해 애플리케이션마다 달리 가지고 있는 분류 방식을 사용했다. 이것은 아주 많은 불편함을 야기했다.

<br>

하지만 오늘날 부라우저들은 이러한 기능들을 한 개의 편리한 패키지에 담아뒀다. URL을 사용하면 이런 애플리케이션들에서 하나의 인터페이스를 통해 **일관된 방식으로 많은 리소스에 접근** 할 수 있다.

웹 브라우저를 사용하면 인터넷 뉴스를 읽으려고 뉴스 리더를 사용할 필요가 없고, FTP 서버에 있는 파일에 접근하려고 FTP 클라이언트를 사용할 필요가 없다. URL은 브라우저가 더 영리하게 리소스에 접근하고 그것을 다루게 한다. 또한 애플리케이션은 URL을 사용하여 정보에 쉽게 접근할 수 있다.

<br>

---

#### 2.2.1 스킴 : 사용할 프로토콜

- 스킴은 URL을 해석하는 애플리케이션이 어떤 프로토콜을 사용하여 리소스를 요청해야 하는지 알려준다. 예를 들어 `http://www.joes-hardware.com:80/index.html` 에서 사용하고 있는 URL의 스킴은 'http'이다.

- 스킴 컴포넌트는 알파벳으로 시작해야 하고 URL의 나머지 부분들과 첫 번째 ':'문자로 구분한다.

---

#### 2.2.2 호스트와 포트

<br>

- URL의 호스트와 포트 컴포넌트는 소스를 호스팅하고 있는 장비와 그 장비 내에서 리소스에 접근할 수 있는 서버가 어디에 있는지 두 가지 정보를 제공해준다.

호스트 컴포넌트는 접근하려고 하는 리소스를 가지고 있는 인터넷상의 호스트
장비를 가리킨다.

<br>

- 포트 컴포넌트는 서버가 열어놓은 네트워크 포트를 가리킨다. 내부적으로 TCP 프
  로토콜을 사용하는 HTTP는 기본 포트로 `80`을 사용한다.

<br>

---

#### 2.2.3 사용자 이름과 비밀번호

- FTP 서버는 자신이 가지고 있는 데이터에 접근을 허용하기 전에 사용자 이름과 비밀번호를 요구하는 좋은 예다.

```
ftp://ftp.prep.ai.mit.edu/pub/gnu
ftp://anonymous@ftp.prep.ai.mit.edu/pub/gnu
ftp://anonymous:my_passwd@ftp.prep.ai.mit.edu/pub/gnu
http://joe:joespasswd@www.joes-hardware.com/sales_info.txt
```

위의 예를 보면, 기본 형식: URL은  scheme://[username[:password]@]host[:port]/path 형식으로 사용자 인증 정보를 포함할 수 있다.

인증 정보 생략 시: 사용자 이름과 비밀번호가 URL에 없을 경우, 애플리케이션은 기본값을 자동으로 사용한다. 예를 들어 FTP 접속 시 사용자 이름은 보통 'anonymous'로 설정되며 비밀번호는 브라우저마다 다른 기본값(예: 크롬의 경우 chrome@example.com)이 사용된다.

사용자 이름만 포함: **ftp://anonymous@...**와 같이 사용자 이름만 명시할 수 있으며 이 경우 비밀번호는 기본값이 적용된다. @ 문자는 사용자 정보를 호스트 주소와 구분하는 역할을 한다.

사용자 이름과 비밀번호 모두 포함: **ftp://anonymous:my_passwd@...** 와 같이 콜론(:)을 사용해 사용자 이름과 비밀번호를 모두 명시할 수 있다. 이는 HTTP와 같은 다른 프로토콜에서도 유사하게 적용된다.

<br>

---

#### 2.2.4 경로

<br>

- URL의 경로 컴포넌트는 리소스가 서버의 어디에 있는지 알려준다.

해당 경로는 아래 예와 같이 계층적 파일 시스템 경로와 유사한 구조를 가진다.

`http://www.joes-hardware.com:80/seasonal/index-fall.html`

---

#### 2.2.5 파라미터

<br>

- URL을 사용하는 애플리케이션이 리소스에 접근하려면 프로토콜 파라미터가 필요하다. 프로토콜 파라미터가 없으면, 다른 한편에 있는 서버는 그 요청을 잘못 처리하거나 처리를 하지 않을 것이다.

<br>

URL의 파라미터 컴포넌트는 애플리케이션이 서버에 정확한 요청을 하기 위해
필요한 입력 파라미터를 받는데 사용한다. 이 컴포넌트는 이름/값 쌍의 리스트로, URL 나머지 부분들로부터 `';'`문자로 구분하여 URL에 기술한다.

이를 통해 애플리케이션이 리소스에 접근하는데 필요한 어떤 추가 정보든 전달할 수 있다.

---

#### 2.2.6 질의 문자열

<br>

- 데이터베이스 같은 서비스들은 요청받을 리소스 형식의 범위를 좁히기 위해서 질문이나 질의를 받을 수 있다.

죠의 컴퓨터 가게가 판매되지 않은 상품의 재고 리스트가 있고, 어떤 상품들이
비축되어 있는지 조회할 수 있다고 해본다면 다음 URL은 아이템 번호 12731의 재고가 있는지 확인하기 위해서 웹 데이터베이스 게이트웨이에 질의하는데 사용된다.

`http://www.joes-hardware.com/inventory-check.cgi?item=12731`

이는 우리가 요청해오던 URL과 거의 유사하다. 다른 점은 물음표(?)의 우측에 있는 값들이다. 이를 **_질의 컴포넌트_** 라고 부른다. URL의 질의 컴포넌트는 게이트웨이를 가리키는 URL의 경로 컴포넌트와 함께 전달하고 있다.

---

#### 2.2.7 프래그먼트

<br>

- HTML 같은 리소스 형식들은 본래의 수준보다 더 작게 나뉠 수 있다. 만일, 절 (paragraph)이 포함된 용량이 큰 한 개의 텍스트 문서의 경우, 그 리소스에 대한 URL은 텍스트 문서 전체를 가리키겠지만, 이상적으로는 리소스 안에 있는 특정 절 을 가리킬 수 있어야 한다.

      리소스의 특정 부분을 가리킬 수 있도록, URL은 리소스 내의 조각을 가리킬 수

  있는 프래그먼트 컴포넌트를 제공한다.

      프래그먼트는 URL의 오른쪽에 #문자에 이어서 온다. 예를 들면 다음과 같다.
      `http://www.joes-hardware.com/tools.html#drills`

<br>

---

### 2.3 단축 URL

<br>

- 웹 클라이언트는 몇몇 단축 URL을 인식하고 사용한다. 상대 URL은 리소스 안에 있는 리소스를 간결하게 기술하는데 사용할 수 있다. 많은 브라우저가 사용자가 기억하고 있는 URL 일부를 입력하면 나머지 부분을 자동으로 입력해주는 URL `'자동확장'`을 지원한다.

<br>

#### 2.3.1 상대 URL

- URL은 상대 URL과 절대 URL 두 가지로 나뉜다.

절대 URL은 리소스에 접근하는데 필요한 모든 정보를 가지고 있다.

그와 달리 상대 URL은 모든 정보를 담고 있지는 않다. 상대 URL로 리소스에 접근하는데 필요한 모든 정보를 얻기 위해서는, 기저(base)라고 하는 다른 URL을 사용해야 한다.

상대 URL은 URL을 짧게 표기하는 방식이다.

---

<br>

#### 2.3.2 URL 확장

- 어떤 브라우저들은 URL을 입력한 다음이나 입력하고 있는 동안에 자동으로 URL을 확장한다. 이는 사용자가 URL을 빠르게 입력하게 도와준다. 자동으로 URL이 확장 되기 때문에 URL 전체를 입력하지 않아도 된다.

이러한 '확장' 기능은 두 가지로 나뉜다.

1. `호스트 명 확장`

   호스트 명 확장 기능을 지원하는 브라우저는 단순한 휴리스틱만을 사용해서 입력한 호스트명을 전체 호스트 명으로 확장할 수 있다.

2. `히스토리 확장`

   사용자가 URL을 입력하는 시간을 줄이고자, 브라우저가 사용하는 또 다른 기술은 과거에 사용자가 방문했던 URL의 기록을 저장해 놓는다.

---

### 2.4 안전하지 않은 문자

<br>

- URL 설계자는 사람들이 URL에 이진데이터나 일반적으로 안전한 알파벳 외의 문자도 포함하려고 할 때가 있다는 것을 알게 되었다. 그래서 이스케이프라는 기능을 추가하여 안전하지 않은 문자를 안전한 문자로 인코딩할 수 있게 하였다.

#### 2.4.1 URL 문자 집합

- `US-ASCII`는 오래된 문자 집합이므로 표현할 수 있는 문자의 수가 적다. 이 때문에 전 세계의 다양한 언어와 특수 문자들을 지원하지 못하는 한계가 있다. 또한 URL이 이진 데이터와 같은 `US-ASCII`에 없는 문자를 포함해야 할 때 문제가 발생했다.

<br>

이러한 문제를 해결하기 위해 URL 설계자들은 이스케이프 문자열을 도입했다.

이스케이프 문자열은 `US-ASCII`에서 사용이 금지된 문자들을 인코딩하는 방식으로 URL의 이동성과 완성도를 높였다.

이는 URL이 7비트 인코딩을 기본으로 사용하기 때문이며 8비트 이상의 데이터가 손실되는 것을 방지하기 위함이다. 공백과 같은 인쇄되지 않는 문자도 이스케이프 처리가 필요하다

<br>

---

#### 2.4.2 인코딩 체계

- 인코딩은 안전하지
  않은 문자를 퍼센티지 기호(%)로 시작해, ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어진 `'이스케이프'` 문자로 바꾼다.

| 문자    | ASC ll 코드 | URL의 예                                             |
| ------- | ----------- | ---------------------------------------------------- |
| -       | 126 ( 0x7E) | http://www.joes-hardware.com/%7Ejoe                  |
| 빈 문자 | 32(0x20)    | http://www.joes-hardware.com/more%20tools.html       |
| %       | 37(0x25)    | http://www.joes-hardware.com/100%25satisfaction.html |

<br>

---

#### 2.4.3 문자 제한

- 몇몇 문자는 URL 내에서 특별한 의미로 예약되어 있다.

```
: (콜론): URL에서 프로토콜과 호스트를 구분하거나 포트 번호를 나타낸다.

/ (슬래시): URL의 경로에서 디렉토리 계층을 구분한다.

? (물음표): URL의 경로 끝에서 질의 문자열(query string)이 시작됨을 나타낸다.

# (해시 또는 샵): URL의 프래그먼트 식별자(fragment identifier)를 나타내며 웹 페이지 내의 특정 섹션으로 이동하는 데 사용된다.

[ ] (대괄호): IPv6 주소를 나타내는 데 사용된다.

@ (앳): 사용자 이름과 비밀번호를 호스트명과 구분한다.

!, $, &, ', (, ), *, +, ,, =, ~ (느낌표, 달러, 앰퍼샌드, 작은따옴표, 괄호, 별표, 더하기, 쉼표, 등호, 물결표): 이들은 질의 문자열이나 다른 특정 컨텍스트에서 특별한 의미를 가진다. 특히 **&**는 여러 질의 매개변수를 구분하는 데 사용되고 **=**는 매개변수 이름과 값을 연결한다.
```

### 2.5 스킴의 종류

주요 스킴의 종류

1. `http`: Hypertext Transfer Protocol의 약자로, 웹에서 가장 일반적인 프로토콜이다. 암호화되지 않은 평문으로 데이터를 주고받아 보안에 취약하다.

2. `https`: Hypertext Transfer Protocol Secure의 약자로, http에 SSL/TLS 프로토콜을 추가하여 데이터를 암호화한 것이다. 보안이 중요한 통신(예: 로그인, 결제)에 사용된다.

3. `ftp`: File Transfer Protocol의 약자로, 파일 전송을 목적으로 하는 프로토콜이다. 대용량 파일을 업로드하거나 다운로드하는 데 사용된다.

4. `mailto`: 전자우편 주소를 나타내는 스킴이다. 웹페이지에서 클릭하면 사용자의 기본 이메일 클라이언트가 열리면서 지정된 주소로 메일을 보낼 수 있게 한다.

5. `file`: 로컬 컴퓨터의 파일에 접근할 때 사용된다. 웹 서버가 아닌 로컬 드라이브의 경로를 나타낸다.

6. `tel`: 전화번호를 나타내는 스킴이다. 모바일 기기에서 클릭하면 해당 전화번호로 전화를 걸 수 있게 한다.

7. `data`: 작은 파일을 URL에 직접 포함시키는 스킴이다. 이미지나 폰트와 같은 파일을 별도의 HTTP 요청 없이 URL 자체에 인코딩하여 포함시킬 수 있다.

8. `ws / wss`: WebSocket 프로토콜을 위한 스킴이다. 웹 서버와 클라이언트 간에 실시간 양방향 통신을 가능하게 한다. wss는 보안(Secure)이 적용된 버전이다.

<br>

이 외에도 다양한 스킴이 존재하며 각각의 목적과 기능에 따라 특정 리소스에 접근하는 방법을 정의한다.
